# Copyright 2023 The Google Research Authors.
#
# Sous licence Apache, Version 2.0 (la "Licence");
# vous ne pouvez pas utiliser ce fichier sauf en conformité avec la Licence.
# Vous pouvez obtenir une copie de la Licence à l'adresse suivante :
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Sauf si requis par la loi applicable ou accepté par écrit, le logiciel distribué sous la Licence est distribué "EN L'ÉTAT",
# SANS GARANTIE NI CONDITION D'AUCUNE SORTE, expresse ou implicite.
# Consultez la Licence pour les termes spécifiques régissant les autorisations et limitations sous la Licence.

"""Bibliothèque utilitaire d'instructions."""

import functools
import random
import re

import immutabledict
import nltk


def download_nltk_resources():
    """Télécharge 'punkt' si non déjà installé."""
    try:
        nltk.data.find("tokenizers/punkt")
    except LookupError:
        nltk.download("punkt")


download_nltk_resources()

WORD_LIST = [
    "ouest",
    "phrase",
    "signal",
    "décharge",
    "point",
    "opposé",
    "fond",
    "pomme de terre",
    "administration",
    "travail",
    "bienvenue",
    "matin",
    "bon",
    "agence",
    "primaire",
    "souhait",
    "responsabilité",
    "presse",
    "problème",
    "président",
    "voler",
    "brosser",
    "lire",
    "type",
    "battre",
    "entraîneur",
    "croissance",
    "verrou",
    "os",
    "cas",
    "égal",
    "confortable",
    "région",
    "remplacement",
    "performance",
    "compagnon",
    "marcher",
    "médecine",
    "film",
    "chose",
    "roche",
    "taper",
    "total",
    "compétition",
    "facilité",
    "sud",
    "établissement",
    "réunir",
    "stationnement",
    "monde",
    "beaucoup",
    "souffle",
    "revendication",
    "alcool",
    "commerce",
    "cher",
    "surligner",
    "rue",
    "importance",
    "décision",
    "désordre",
    "accord",
    "studio",
    "coach",
    "aider",
    "cerveau",
    "aile",
    "style",
    "privé",
    "haut",
    "marron",
    "jambe",
    "acheter",
    "procédure",
    "méthode",
    "vitesse",
    "élevé",
    "entreprise",
    "précieux",
    "tarte",
    "analyste",
    "session",
    "modèle",
    "district",
    "plaisir",
    "dîner",
    "nage",
    "blague",
    "ordre",
    "assiette",
    "département",
    "moteur",
    "cellule",
    "dépenser",
    "armoire",
    "différence",
    "puissance",
    "examen",
    "moteur",
    "cheval",
    "dimension",
    "payer",
    "orteil",
    "courbe",
    "littérature",
    "gêner",
    "feu",
    "possibilité",
    "débat",
    "activité",
    "passage",
    "bonjour",
    "cycle",
    "arrière-plan",
    "silence",
    "auteur",
    "effet",
    "acteur",
    "page",
    "vélo",
    "erreur",
    "gorge",
    "attaque",
    "personnage",
    "téléphone",
    "thé",
    "augmentation",
    "résultat",
    "fichier",
    "spécifique",
    "inspecteur",
    "interne",
    "potentiel",
    "personnel",
    "bâtiment",
    "employeur",
    "chaussure",
    "main",
    "direction",
    "jardin",
    "achat",
    "entretien",
    "étude",
    "reconnaissance",
    "membre",
    "spirituel",
    "four",
    "sandwich",
    "étrange",
    "passager",
    "particulier",
    "réponse",
    "réaction",
    "taille",
    "variation",
    "un",
    "annuler",
    "bonbon",
    "sortie",
    "invité",
    "condition",
    "voler",
    "prix",
    "faiblesse",
    "convertir",
    "hôtel",
    "génial",
    "bouche",
    "esprit",
    "chanson",
    "sucre",
    "suspect",
    "téléphone",
    "oreille",
    "toit",
    "peinture",
    "réfrigérateur",
    "organisation",
    "jury",
    "récompense",
    "ingénierie",
    "jour",
    "possession",
    "équipage",
    "bar",
    "route",
    "description",
    "célébration",
    "score",
    "marque",
    "lettre",
    "douche",
    "suggestion",
    "monsieur",
    "chance",
    "national",
    "progrès",
    "salle",
    "coup",
    "théorie",
    "offre",
    "histoire",
    "impôt",
    "définition",
    "histoire",
    "balade",
    "moyen",
    "ouverture",
    "verre",
    "ascenseur",
    "estomac",
    "question",
    "capacité",
    "principal",
    "village",
    "ordinateur",
    "ville",
    "grand",
    "confiance",
    "bougie",
    "prêtre",
    "recommandation",
    "point",
    "nécessaire",
    "corps",
    "bureau",
    "secret",
    "horreur",
    "bruit",
    "culture",
    "avertissement",
    "eau",
    "rond",
    "régime",
    "fleur",
    "bus",
    "dur",
    "permission",
    "semaine",
    "rapide",
    "connexion",
    "abus",
    "hauteur",
    "sauvegarder",
    "coin",
    "frontière",
    "stress",
    "conduire",
    "arrêter",
    "déchirer",
    "repas",
    "écouter",
    "confusion",
    "petite amie",
    "vie",
    "relation",
    "signification",
    "plan",
    "créatif",
    "atmosphère",
    "blâmer",
    "inviter",
    "logement",
    "papier",
    "boisson",
    "rouleau",
    "argent",
    "ivre",
    "âge",
    "dommage",
    "fumée",
    "environnement",
    "paquet",
    "économies",
    "influence",
    "touriste",
    "pluie",
    "poste",
    "signe",
    "grand-mère",
    "courir",
    "profit",
    "pousser",
    "commis",
    "final",
    "vin",
    "nager",
    "pause",
    "affaires",
    "chanteur",
    "funérailles",
    "moyenne",
    "source",
    "scène",
    "tradition",
    "personnel",
    "neige",
    "personne",
    "distance",
    "type",
    "sensible",
    "animal",
    "majeur",
    "négociation",
    "clic",
    "humeur",
    "période",
    "arrivée",
    "expression",
    "vacances",
    "répéter",
    "poussière",
    "placard",
    "or",
    "mauvais",
    "naviguer",
    "combinaison",
    "vêtements",
    "emphase",
    "devoir",
    "noir",
    "étape",
    "école",
    "sauter",
    "document",
    "professionnel",
    "lèvre",
    "chimique",
    "devant",
    "réveil",
    "pendant",
    "intérieur",
    "regarder",
    "rangée",
    "sujet",
    "pénalité",
    "équilibre",
    "possible",
    "adulte",
    "côté",
    "échantillon",
    "appel",
    "mariage",
    "profondeur",
    "roi",
    "prix",
    "femme",
    "coup",
    "site",
    "camp",
    "musique",
    "sûr",
    "cadeau",
    "faute",
    "deviner",
    "acte",
    "honte",
    "drame",
    "capital",
    "examen",
    "stupide",
    "enregistrement",
    "son",
    "balancer",
    "roman",
    "minimum",
    "ratio",
    "machine",
    "forme",
    "diriger",
    "opération",
    "salaire",
    "nuage",
    "affaire",
    "frapper",
    "chapitre",
    "scène",
    "quantité",
    "accès",
    "armée",
    "chaîne",
    "trafic",
    "coup de pied",
    "analyse",
    "aéroport",
    "temps",
    "vacances",
    "philosophie",
    "balle",
    "poitrine",
    "merci",
    "lieu",
    "montagne",
    "publicité",
    "rouge",
    "passé",
    "loyer",
    "retour",
    "tour",
    "maison",
    "construction",
    "filet",
    "natif",
    "guerre",
    "figure",
    "frais",
    "pulvérisation",
    "utilisateur",
    "poussière",
    "coup",
    "tâche",
    "bâton",
    "ami",
    "logiciel",
    "promotion",
    "interaction",
    "environner",
    "bloc",
    "but",
    "pratique",
    "conflit",
    "routine",
    "exigence",
    "bonus",
    "trou",
    "état",
    "junior",
    "doux",
    "attraper",
    "larme",
    "pli",
    "mur",
    "éditeur",
    "vie",
    "position",
    "livre",
    "respect",
    "salle de bain",
    "manteau",
    "scénario",
    "travail",
    "enseigner",
    "naissance",
    "vue",
    "résoudre",
    "thème",
    "employé",
    "doute",
    "marché",
    "éducation",
    "servir",
    "récupérer",
    "ton",
    "mal",
    "manquer",
    "union",
    "compréhension",
    "vache",
    "rivière",
    "association",
    "concept",
    "formation",
    "recette",
    "relation",
    "réserve",
    "dépression",
    "preuve",
    "cheveux",
    "revenu",
    "indépendant",
    "ascenseur",
    "affectation",
    "temporaire",
    "montant",
    "perte",
    "bord",
    "piste",
    "vérifier",
    "corde",
    "estimation",
    "pollution",
    "stable",
    "message",
    "livraison",
    "perspective",
    "miroir",
    "assistant",
    "représentant",
    "témoin",
    "nature",
    "juge",
    "fruit",
    "conseil",
    "diable",
    "ville",
    "urgence",
    "supérieur",
    "chute",
    "séjour",
    "humain",
    "cou",
    "haut-parleur",
    "réseau",
    "chanter",
    "résister",
    "ligue",
    "voyage",
    "signature",
    "avocat",
    "importance",
    "gaz",
    "choix",
    "ingénieur",
    "succès",
    "partie",
    "externe",
    "travailleur",
    "simple",
    "quart",
    "étudiant",
    "cœur",
    "passer",
    "mépris",
    "changement",
    "dur",
    "dame",
    "herbe",
    "communauté",
    "garage",
    "jeunesse",
    "standard",
    "jupe",
    "promesse",
    "aveugle",
    "télévision",
    "maladie",
    "commission",
    "positif",
    "énergie",
    "calme",
    "présence",
    "accord",
    "base",
    "préférence",
    "tête",
    "commun",
    "coupure",
    "quelque part",
    "présentation",
    "actuel",
    "pensée",
    "révolution",
    "effort",
    "maître",
    "mettre en œuvre",
    "république",
    "sol",
    "principe",
    "étranger",
    "épaule",
    "classe",
    "bouton",
    "tennis",
    "police",
    "collection",
    "compte",
    "inscription",
    "gants",
    "diviser",
    "professeur",
    "chaise",
    "priorité",
    "combiner",
    "paix",
    "extension",
    "peut-être",
    "soirée",
    "cadre",
    "sœur",
    "vague",
    "code",
    "application",
    "souris",
    "allumette",
    "comptoir",
    "bouteille",
    "moitié",
    "joue",
    "résolution",
    "arrière",
    "connaissance",
    "faire",
    "discussion",
    "vis",
    "longueur",
    "accident",
    "bataille",
    "robe",
    "genou",
    "journal",
    "paquet",
    "il",
    "tourner",
    "audition",
    "journal",
    "couche",
    "richesse",
    "profil",
    "imagination",
    "réponse",
    "week-end",
    "enseignant",
    "apparence",
    "rencontre",
    "vélo",
    "croître",
    "ceinture",
    "crash",
    "bol",
    "équivalent",
    "soutien",
    "image",
    "poème",
    "risque",
    "excitation",
    "télécommande",
    "secrétaire",
    "public",
    "produire",
    "avion",
    "affichage",
    "argent",
    "sable",
    "situation",
    "poing",
    "client",
    "titre",
    "secouer",
    "hypothèque",
    "option",
    "numéro",
    "pop",
    "fenêtre",
    "étendue",
    "rien",
    "expérience",
    "opinion",
    "départ",
    "danse",
    "indication",
    "garçon",
    "matériel",
    "bande",
    "leader",
    "soleil",
    "beau",
    "muscle",
    "fermier",
    "variété",
    "graisse",
    "poignée",
    "directeur",
    "opportunité",
    "calendrier",
    "extérieur",
    "rythme",
    "bain",
    "poisson",
    "conséquence",
    "mettre",
    "propriétaire",
    "aller",
    "docteur",
    "information",
    "partager",
    "blesser",
    "protection",
    "carrière",
    "finance",
    "force",
    "golf",
    "ordures",
    "aspect",
    "enfant",
    "nourriture",
    "bottes",
    "lait",
    "répondre",
    "objectif",
    "réalité",
    "brut",
    "anneau",
    "centre commercial",
    "un",
    "impact",
    "zone",
    "nouvelles",
    "international",
    "série",
    "impressionner",
    "mère",
    "abri",
    "frappe",
    "prêt",
    "mois",
    "siège",
    "tout",
    "divertissement",
    "familier",
    "indice",
    "année",
    "heureux",
    "supermarché",
    "naturel",
    "dieu",
    "coût",
    "conversation",
    "cravate",
    "ruiner",
    "confort",
    "terre",
    "tempête",
    "pourcentage",
    "assistance",
    "budget",
    "force",
    "début",
    "sommeil",
    "autre",
    "jeune",
    "unité",
    "remplir",
    "magasin",
    "désir",
    "cacher",
    "valeur",
    "tasse",
    "entretien",
    "infirmière",
    "fonction",
    "tour",
    "rôle",
    "classe",
    "caméra",
    "base de données",
    "panique",
    "nation",
    "panier",
    "glace",
    "art",
    "esprit",
    "graphique",
    "échange",
    "retour",
    "réputation",
    "recherche",
    "chasse",
    "exercice",
    "méchant",
    "remarque",
    "mâle",
    "cour",
    "annuel",
    "col",
    "date",
    "plateforme",
    "plante",
    "fortune",
    "passion",
    "amitié",
    "propagation",
    "cancer",
    "billet",
    "attitude",
    "île",
    "actif",
    "objet",
    "service",
    "acheteur",
    "morsure",
    "carte",
    "visage",
    "steak",
    "proposition",
    "patient",
    "chaleur",
    "règle",
    "résident",
    "large",
    "politique",
    "ouest",
    "couteau",
    "expert",
    "fille",
    "design",
    "sel",
    "base-ball",
    "attraper",
    "inspection",
    "cousin",
    "couple",
    "magazine",
    "cuisinier",
    "dépendant",
    "sécurité",
    "poulet",
    "version",
    "devise",
    "échelle",
    "schéma",
    "cuisine",
    "emploi",
    "local",
    "attention",
    "directeur",
    "fait",
    "couvrir",
    "triste",
    "garde",
    "parent",
    "comté",
    "taux",
    "déjeuner",
    "programme",
    "initiative",
    "équipement",
    "pont",
    "poitrine",
    "parler",
    "plat",
    "garantie",
    "bière",
    "véhicule",
    "réception",
    "femme",
    "substance",
    "copie",
    "conférence",
    "avantage",
    "parc",
    "froid",
    "mort",
    "mélange",
    "tenir",
    "échelle",
    "demain",
    "sang",
    "demande",
    "vert",
    "biscuit",
    "église",
    "bande",
    "toujours",
    "au-delà",
    "dette",
    "s'occuper",
    "laver",
    "suivant",
    "ressentir",
    "maximum",
    "secteur",
    "mer",
    "propriété",
    "économie",
    "menu",
    "banc",
    "essayer",
    "langue",
    "départ",
    "appel",
    "solide",
    "adresse",
    "revenu",
    "pied",
    "supérieur",
    "chéri",
    "peu",
    "mélange",
    "argent",
    "épicerie",
    "lien",
    "carte",
    "formulaire",
    "facteur",
    "pot",
    "modèle",
    "écrivain",
    "ferme",
    "hiver",
    "compétence",
    "partout",
    "anniversaire",
    "politique",
    "sortie",
    "mari",
    "laboratoire",
    "se dépêcher",
    "courrier",
    "équipement",
    "évier",
    "paire",
    "conducteur",
    "considération",
    "cuir",
    "peau",
    "bleu",
    "bateau",
    "vente",
    "brique",
    "deux",
    "nourrir",
    "carré",
    "point",
    "se précipiter",
    "rêve",
    "emplacement",
    "après-midi",
    "fabricant",
    "contrôle",
    "occasion",
    "problème",
    "introduction",
    "conseil",
    "parier",
    "manger",
    "tuer",
    "catégorie",
    "manière",
    "bureau",
    "propriété",
    "fierté",
    "conscience",
    "glisser",
    "fissure",
    "client",
    "ongle",
    "tirer",
    "adhésion",
    "doux",
    "n'importe qui",
    "web",
    "officiel",
    "individuel",
    "pizza",
    "intérêt",
    "sac",
    "épeler",
    "profession",
    "reine",
    "accord",
    "ressource",
    "bateau",
    "gars",
    "chocolat",
    "joint",
    "formel",
    "en haut",
    "voiture",
    "station",
    "étranger",
    "dépositaire",
    "partenaire",
    "doigt",
    "chirurgie",
    "commentaire",
    "équipe",
    "détail",
    "fou",
    "chemin",
    "histoire",
    "initiale",
    "bras",
    "radio",
    "demande",
    "simple",
    "tirer",
    "jaune",
    "concours",
    "morceau",
    "citation",
    "tirer",
    "commercial",
    "chemise",
    "contribution",
    "crème",
    "chaîne",
    "costume",
    "discipline",
    "instruction",
    "concert",
    "discours",
    "bas",
    "efficace",
    "accrocher",
    "gratter",
    "industrie",
    "petit déjeuner",
    "poser",
    "joindre",
    "métal",
    "chambre",
    "minute",
    "produit",
    "repos",
    "température",
    "beaucoup",
    "donner",
    "discussion",
    "imprimer",
    "violet",
    "rire",
    "santé",
    "crédit",
    "investissement",
    "vendre",
    "réglage",
    "leçon",
    "œuf",
    "milieu",
    "mariage",
    "niveau",
    "preuve",
    "phrase",
    "amour",
    "soi",
    "avantage",
    "orientation",
    "affecter",
    "toi",
    "papa",
    "anxiété",
    "spécial",
    "petit ami",
    "test",
    "vide",
    "paiement",
    "soupe",
    "obligation",
    "répondre",
    "sourire",
    "profond",
    "plainte",
    "ajout",
    "révision",
    "boîte",
    "serviette",
    "mineur",
    "plaisir",
    "sol",
    "problème",
    "cigarette",
    "internet",
    "gain",
    "dire",
    "entrée",
    "supplémentaire",
    "incident",
    "famille",
    "refuser",
    "branche",
    "peut",
    "stylo",
    "grand-père",
    "constant",
    "réservoir",
    "oncle",
    "climat",
    "sol",
    "volume",
    "communication",
    "genre",
    "poète",
    "enfant",
    "écran",
    "le mien",
    "arrêter",
    "gène",
    "manque",
    "charité",
    "mémoire",
    "dent",
    "peur",
    "mentionner",
    "marketing",
    "révéler",
    "raison",
    "cour",
    "saison",
    "liberté",
    "terre",
    "sport",
    "public",
    "salle de classe",
    "loi",
    "crochet",
    "gagner",
    "porter",
    "œil",
    "odeur",
    "distribution",
    "recherche",
    "pays",
    "oser",
    "espoir",
    "alors que",
    "étirement",
    "bibliothèque",
    "si",
    "retard",
    "collège",
    "plastique",
    "livre",
    "présent",
    "utilisation",
    "inquiétude",
    "champion",
    "but",
    "économie",
    "mars",
    "élection",
    "réflexion",
    "minuit",
    "diapositive",
    "inflation",
    "action",
    "défi",
    "guitare",
    "côte",
    "pomme",
    "campagne",
    "champ",
    "veste",
    "sens",
    "chemin",
    "visuel",
    "retirer",
    "temps",
    "ordures",
    "câble",
    "regret",
    "copain",
    "plage",
    "historien",
    "courage",
    "sympathie",
    "camion",
    "tension",
    "permis",
    "nez",
    "lit",
    "fils",
    "personne",
    "base",
    "viande",
    "habituel",
    "air",
    "réunion",
    "valeur",
    "jeu",
    "indépendance",
    "physique",
    "court",
    "jouer",
    "soulever",
    "tableau",
    "elle",
    "clé",
    "écriture",
    "choisir",
    "commande",
    "fête",
    "hier",
    "printemps",
    "candidat",
    "physique",
    "université",
    "préoccupation",
    "développement",
    "changement",
    "chaîne",
    "objectif",
    "exemple",
    "salle",
    "amer",
    "oiseau",
    "football",
    "normal",
    "diviser",
    "impression",
    "bois",
    "long",
    "sens",
    "stock",
    "casquette",
    "leadership",
    "médias",
    "ambition",
    "pêche",
    "essai",
    "salade",
    "réparation",
    "aujourd'hui",
    "designer",
    "nuit",
    "banque",
    "dessin",
    "inévitable",
    "phase",
    "vaste",
    "puce",
    "colère",
    "interrupteur",
    "crier",
    "tordre",
    "personnalité",
    "tentative",
    "stockage",
    "être",
    "préparation",
    "chauve-souris",
    "sélection",
    "blanc",
    "technologie",
    "contrat",
    "côté",
    "section",
    "station",
    "jusqu'à",
    "structure",
    "langue",
    "goût",
    "vérité",
    "difficulté",
    "groupe",
    "limite",
    "principal",
    "mouvement",
    "sentiment",
    "lumière",
    "exemple",
    "mission",
    "pouvoir",
    "attendre",
    "roue",
    "magasin",
    "hôte",
    "classique",
    "alternative",
    "cause",
    "agent",
    "consister",
    "table",
    "compagnie aérienne",
    "texte",
    "piscine",
    "métier",
    "gamme",
    "carburant",
    "outil",
    "partenaire",
    "charge",
    "entrée",
    "dépôt",
    "haine",
    "article",
    "vidéo",
    "été",
    "caractéristique",
    "extrême",
    "mobile",
    "hôpital",
    "vol",
    "chute",
    "pension",
    "piano",
    "échouer",
    "résultat",
    "frotter",
    "écart",
    "système",
    "rapport",
    "aspirer",
    "ordinaire",
    "vent",
    "nerf",
    "demander",
    "briller",
    "note",
    "ligne",
    "maman",
    "perception",
    "frère",
    "référence",
    "plier",
    "charge",
    "traiter",
    "tromperie",
    "terme",
    "devoirs",
    "cuire",
    "enchère",
    "statut",
    "projet",
    "stratégie",
    "orange",
    "laisser",
    "enthousiasme",
    "parent",
    "concentrer",
    "appareil",
    "voyage",
    "poésie",
    "entreprise",
    "société",
    "baiser",
    "fin",
    "légume",
    "employé",
    "calendrier",
    "heure",
    "courageux",
    "focus",
    "processus",
    "film",
    "illégal",
    "général",
    "café",
    "publicité",
    "autoroute",
    "chimie",
    "psychologie",
    "embaucher",
    "cloche",
    "conférence",
    "soulagement",
    "montrer",
    "propre",
    "drôle",
    "poids",
    "qualité",
    "club",
    "fille",
    "zone",
    "toucher",
    "ce soir",
    "choc",
    "brûler",
    "excuse",
    "nom",
    "enquête",
    "paysage",
    "avancer",
    "satisfaction",
    "pain",
    "catastrophe",
    "article",
    "chapeau",
    "précédent",
    "courses",
    "visite",
    "est",
    "photo",
    "maison",
    "idée",
    "père",
    "comparaison",
    "chat",
    "tuyau",
    "gagnant",
    "compter",
    "lac",
    "combattre",
    "prix",
    "fondation",
    "chien",
    "garder",
    "idéal",
    "ventilateur",
    "lutte",
    "pic",
    "sécurité",
    "solution",
    "enfer",
    "conclusion",
    "population",
    "contrainte",
    "alarme",
    "mesure",
    "seconde",
    "train",
    "course",
    "attente",
    "assurance",
    "patron",
    "arbre",
    "écran",
    "malade",
    "cours",
    "tirer",
    "rendez-vous",
    "tranche",
    "encore",
    "soin",
    "patience",
    "riche",
    "s'échapper",
    "émotion",
    "royal",
    "femelle",
    "enfance",
    "gouvernement",
    "photo",
    "volonté",
    "chaussette",
    "grand",
    "porte",
    "huile",
    "croix",
    "épingle",
    "amélioration",
    "championnat",
    "stupide",
    "aide",
    "ciel",
    "pitch",
    "homme",
    "diamant",
    "plus",
    "transition",
    "travail",
    "science",
    "comité",
    "moment",
    "réparation",
    "enseignement",
    "creuser",
    "spécialiste",
    "complexe",
    "guide",
    "personnes",
    "mort",
    "voix",
    "original",
    "pause",
    "sujet",
    "données",
    "degré",
    "lecture",
    "enregistrement",
    "groupe",
    "atteindre",
    "jugement",
    "mensonge",
    "régulier",
    "ensemble",
    "peinture",
    "mode",
    "liste",
    "joueur",
    "ours",
    "nord",
    "merveille",
    "tapis",
    "lourd",
    "officier",
    "négatif",
    "horloge",
    "unique",
    "bébé",
    "douleur",
    "supposition",
    "disque",
    "fer",
    "facture",
    "tiroir",
    "regard",
    "double",
    "erreur",
    "finir",
    "avenir",
    "brillant",
    "contact",
    "maths",
    "riz",
    "laisser",
    "restaurant",
    "réduction",
    "sexe",
    "virus",
    "morceau",
    "confiance",
    "événement",
    "porter",
    "jus",
    "échec",
    "bogue",
    "contexte",
    "boue",
    "tout",
    "envelopper",
    "intention",
    "brouillon",
    "pression",
    "gâteau",
    "sombre",
    "explication",
    "espace",
    "angle",
    "mot",
    "efficacité",
    "gestion",
    "habitude",
    "étoile",
    "chance",
    "découverte",
    "transport",
    "support",
    "critique",
    "flux",
    "porte",
    "blessure",
    "insecte",
    "surprise",
    "appartement",
]  # pylint: disable=line-too-long

# Codes ISO 639-1 pour les noms de langue.
LANGUAGE_CODES = immutabledict.immutabledict(
    {
        "en": "Anglais",
        "es": "Espagnol",
        "pt": "Portugais",
        "ar": "Arabe",
        "hi": "Hindi",
        "fr": "Français",
        "ru": "Russe",
        "de": "Allemand",
        "ja": "Japonais",
        "it": "Italien",
        "bn": "Bengali",
        "uk": "Ukrainien",
        "th": "Thaï",
        "ur": "Ourdou",
        "ta": "Tamoul",
        "te": "Télougou",
        "bg": "Bulgare",
        "ko": "Coréen",
        "pl": "Polonais",
        "he": "Hébreu",
        "fa": "Persan",
        "vi": "Vietnamien",
        "ne": "Népalais",
        "sw": "Swahili",
        "kn": "Kannada",
        "mr": "Marathi",
        "gu": "Gujarati",
        "pa": "Pendjabi",
        "ml": "Malayalam",
        "fi": "Finnois",
    }
)

_ALPHABETS = "([A-Za-z])"
_PREFIXES = "(Mr|St|Mrs|Ms|Dr)[.]"
_SUFFIXES = "(Inc|Ltd|Jr|Sr|Co)"
_STARTERS = r"(Mr|Mrs|Ms|Dr|Prof|Capt|Cpt|Lt|He\s|She\s|It\s|They\s|Their\s|Our\s|We\s|But\s|However\s|That\s|This\s|Wherever)"
_ACRONYMS = "([A-Z][.][A-Z][.](?:[A-Z][.])?)"
_WEBSITES = "[.](com|net|org|io|gov|edu|me)"
_DIGITS = "([0-9])"
_MULTIPLE_DOTS = r"\.{2,}"


def split_into_sentences(text):
    """Split the text into sentences.

    Args:
      text: A string that consists of more than or equal to one sentences.

    Returns:
      A list of strings where each string is a sentence.
    """
    text = " " + text + "  "
    text = text.replace("\n", " ")
    text = re.sub(_PREFIXES, "\\1<prd>", text)
    text = re.sub(_WEBSITES, "<prd>\\1", text)
    text = re.sub(_DIGITS + "[.]" + _DIGITS, "\\1<prd>\\2", text)
    text = re.sub(
        _MULTIPLE_DOTS,
        lambda match: "<prd>" * len(match.group(0)) + "<stop>",
        text,
    )
    if "Ph.D" in text:
        text = text.replace("Ph.D.", "Ph<prd>D<prd>")
    text = re.sub(r"\s" + _ALPHABETS + "[.] ", " \\1<prd> ", text)
    text = re.sub(_ACRONYMS + " " + _STARTERS, "\\1<stop> \\2", text)
    text = re.sub(
        _ALPHABETS + "[.]" + _ALPHABETS + "[.]" + _ALPHABETS + "[.]",
        "\\1<prd>\\2<prd>\\3<prd>",
        text,
    )
    text = re.sub(_ALPHABETS + "[.]" + _ALPHABETS + "[.]", "\\1<prd>\\2<prd>", text)
    text = re.sub(" " + _SUFFIXES + "[.] " + _STARTERS, " \\1<stop> \\2", text)
    text = re.sub(" " + _SUFFIXES + "[.]", " \\1<prd>", text)
    text = re.sub(" " + _ALPHABETS + "[.]", " \\1<prd>", text)
    if "”" in text:
        text = text.replace(".”", "”.")
    if '"' in text:
        text = text.replace('."', '".')
    if "!" in text:
        text = text.replace('!"', '"!')
    if "?" in text:
        text = text.replace('?"', '"?')
    text = text.replace(".", ".<stop>")
    text = text.replace("?", "?<stop>")
    text = text.replace("!", "!<stop>")
    text = text.replace("<prd>", ".")
    sentences = text.split("<stop>")
    sentences = [s.strip() for s in sentences]
    if sentences and not sentences[-1]:
        sentences = sentences[:-1]
    return sentences

def count_words(text):
    """Counts the number of words."""
    tokenizer = nltk.tokenize.RegexpTokenizer(r"\w+")
    tokens = tokenizer.tokenize(text)
    num_words = len(tokens)
    return num_words



@functools.lru_cache(maxsize=None)
def _get_sentence_tokenizer():
    return nltk.data.load("nltk:tokenizers/punkt/french.pickle")


def count_sentences(text):
    """Count the number of sentences."""
    tokenizer = _get_sentence_tokenizer()
    tokenized_sentences = tokenizer.tokenize(text)
    return len(tokenized_sentences)


def generate_keywords(num_keywords):
    """Randomly generates a few keywords."""
    return random.sample(WORD_LIST, k=num_keywords)